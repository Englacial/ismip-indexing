# ISMIP6 Interactive Comparison Tool - Configuration
# This file contains all configurable parameters for the application

# Data Sources
data_sources:
  # Google Cloud Storage bucket for ISMIP6 data
  gcs_bucket: "gs://ismip6"
  gcs_http_base: "https://storage.googleapis.com/ismip6"

  # Local cache directory for file index
  cache_dir: ".cache"
  index_cache_file: ".cache/ismip6_index.parquet"

  # Metadata files
  variables_yaml: "table_a1_variables.yaml"
  experiments_yaml: "ismip6_experiments.yaml"

# Application Settings
app:
  title: "ISMIP6 Interactive Comparison Tool"
  port: 5006

  # Theme configuration
  theme:
    name: "default"  # or "dark"
    accent_color: "#0072B2"
    header_background: "#0072B2"

  # Sidebar configuration
  sidebar:
    width: 340

  # Default selections (automatically loaded on first page load)
  defaults:
    variable: "litempbotgr"  # Basal mass balance flux beneath floating ice
    models:
      - "NCAR/CISM"
      - "DOE/MALI"
      - "AWI/PISM1"
      - "LSCE/GRISLI2"
    experiments:
      - "exp05"
    colormap_mode: "auto"
    nan_values: "0"
    auto_range: true
    auto_load: true  # Automatically trigger loading on first page load

# Data Loading
data_loading:
  # Default NaN replacement values
  default_nan_values: [0]

  # Time step options
  time_step_modes:
    - first
    - last
    - all
    - custom

  # Colormap options
  colormap_options:
    - auto
    - viridis
    - Blues
    - RdBu_r
    - plasma
    - cividis
    - magma
    - inferno

  # Engine for reading NetCDF files
  netcdf_engine: "h5netcdf"

# Visualization
visualization:

  # Default colormap for different data types
  colormap_defaults:
    diverging: "RdBu_r"  # Data crossing zero
    sequential_positive: "Blues"  # Positive data
    sequential_negative: "Blues_r"  # Negative data
    general: "viridis"  # General purpose

  # Color range calculation
  percentile_range:
    low: 2.0
    high: 98.0

  # Plot tools
  tools:
    - hover
    - pan
    - wheel_zoom
    - box_zoom
    - reset

  # Toolbar position
  toolbar: "above"

  # Font sizes
  fontsize:
    title: 11
    labels: 10
    xticks: 8
    yticks: 8

  # Grid layout
  layout:
    columns: 2  # Number of columns for plot grid
    shared_axes: true
    merge_tools: false

# Grid Correction
grid_correction:
  # ISMIP6 standard grid bounds (EPSG:3031)
  bounds:
    x_min: -3040000.0  # meters
    x_max: 3040000.0
    y_min: -3040000.0
    y_max: 3040000.0

  # Standard resolutions (meters)
  standard_resolutions:
    - 32000
    - 16000
    - 8000
    - 4000
    - 2000
    - 1000

  # Tolerance for resolution matching (fraction)
  resolution_tolerance: 0.1

  # Coordinate system
  projection: "EPSG:3031"
  projection_name: "Antarctic Polar Stereographic"

# UI Settings
ui:
  # Loading indicator
  loading_spinner:
    size: 80
    color: "primary"

  # Info box
  info_box:
    show_file_count: true
    show_total_size: true
    show_estimated_time: true

  # Advanced options (collapsible section)
  advanced_options:
    default_collapsed: true

  # Notifications
  notifications:
    enabled: true
    success_duration: 3000  # milliseconds
    warning_duration: 5000
    error_duration: 10000

# URL Parameters (for shareable links)
url_params:
  enabled: true
  param_names:
    variable: "var"
    models: "models"
    experiments: "exps"
    time_step_mode: "time_mode"
    time_step: "time_step"
    colormap: "cmap"
    nan_values: "nan"

  # Delimiter for list parameters
  list_delimiter: ","

# Debug and Logging
debug:
  # Enable verbose console logging
  verbose: true

  # Log file loading details
  log_file_loading: true

  # Log grid corrections
  log_grid_corrections: true

  # Show performance metrics
  show_performance_metrics: false

# Performance
performance:
  # Cache settings
  cache_file_index: true
  cache_loaded_datasets: true

  # Dataset cache configuration
  dataset_cache:
    max_items: 20  # Maximum number of NetCDF files to cache in memory
    policy: "LRU"  # Cache eviction policy: LRU, LFU, or FIFO

  # Memory limits
  max_sample_values: 1000000  # For color range calculation

  # Async settings
  use_async_loading: true

# File Index
file_index:
  # Force rebuild of index
  force_rebuild: false

  # Columns to include
  columns:
    - variable
    - ice_sheet
    - institution
    - model_name
    - experiment
    - url
    - size_bytes

  # Derived columns
  derived_columns:
    model: "institution + '/' + model_name"

# Metadata Display
metadata:
  # Show variable descriptions in tooltips
  show_variable_descriptions: true

  # Show experiment descriptions
  show_experiment_descriptions: true

  # Show model information
  show_model_info: false  # Future feature

  # Format for descriptions
  description_format: "{description}"  # Can include {units}, {standard_name}, etc.
